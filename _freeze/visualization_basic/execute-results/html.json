{
  "hash": "9c07f4f0194bb37e89b4cf943a431d8e",
  "result": {
    "engine": "knitr",
    "markdown": "# データ可視化入門 - ggplot2基礎\n\nデータを数値で見ることも大切ですが、グラフやチャートで視覚化することで、データの特徴やパターンがより明確になります。\n\nRの`ggplot2`パッケージは、美しく柔軟性の高いグラフを作成するための強力なツールです。この章では、ggplot2の基本を学び、基本的なグラフが作成できるようになります。\n\n## 学習内容\n\nこの章を読み終えると、以下ができるようになります。\n\n- ggplot2の基本的な文法を理解する\n- 散布図を作成する\n- 折れ線グラフを作成する\n- 棒グラフを作成する\n- ヒストグラムを作成する\n- グラフにタイトルやラベルを追加する\n\n## ggplot2とは\n\n`ggplot2`は、「Grammar of Graphics」（グラフィックスの文法）という考え方に基づいたパッケージです。\n\nグラフを「データ」「視覚的要素（点、線など）」「座標系」などの部品を組み合わせて作ることで、柔軟で一貫性のある可視化が可能になります。\n\n### パッケージの準備\n\n```r\n# tidyverseに含まれています\nlibrary(tidyverse)\n\n# またはggplot2だけを読み込む\nlibrary(ggplot2)\n```\n\n## ggplot2の基本構造\n\nggplot2でグラフを作る際の基本的な構造は以下の通りです。\n\n```r\nggplot(data = データ, aes(x = x軸の変数, y = y軸の変数)) +\n  geom_点や線の種類()\n```\n\n- `ggplot()`: グラフの土台を作る\n- `aes()`: Aesthetics（美的要素）の略。どの変数をx軸・y軸などに割り当てるかを指定\n- `geom_*()`: Geometry（幾何要素）の略。点、線、棒などの表現方法を指定\n\n重要なのは`+`でレイヤーを重ねていくという考え方です。\n\n## 散布図（Scatter Plot）\n\n2つの連続変数の関係を見るには散布図が適しています。\n\n### 基本的な散布図\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\ndata(iris)\n\n# がく片の長さと幅の関係を散布図で表示\nggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n### 点の大きさや色を変更\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 点を大きく、赤色に\nggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width)) +\n  geom_point(size = 3, color = \"red\")\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n### 透明度の調整\n\n点が重なっている場合、透明度を調整すると見やすくなります。\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 透明度を設定（0が完全透明、1が不透明）\nggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width)) +\n  geom_point(size = 3, alpha = 0.5)\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n### カテゴリごとに色分け\n\n`aes()`の中で`color`を指定すると、カテゴリごとに自動で色分けされます。\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 品種ごとに色分け\nggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +\n  geom_point(size = 3, alpha = 0.7)\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## 折れ線グラフ（Line Plot）\n\n時系列データや連続的な変化を表現するには折れ線グラフが適しています。\n\n### サンプルデータの作成\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 月次売上データを作成\nmonthly_sales <- data.frame(\n  月 = 1:12,\n  売上 = c(120, 135, 150, 145, 160, 175, 190, 185, 200, 210, 230, 250)\n)\n```\n:::\n\n\n### 基本的な折れ線グラフ\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = monthly_sales, aes(x = 月, y = 売上)) +\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### 点と線を組み合わせる\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = monthly_sales, aes(x = 月, y = 売上)) +\n  geom_line(color = \"blue\", linewidth = 1) +\n  geom_point(color = \"red\", size = 3)\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## 棒グラフ（Bar Plot）\n\nカテゴリごとの値を比較するには棒グラフが適しています。\n\n### カウント数の棒グラフ\n\n`geom_bar()`は自動的にカウントを計算します。\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 品種ごとのデータ数\nggplot(data = iris, aes(x = Species)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n### 値を直接指定する棒グラフ\n\n既に集計済みのデータの場合は`geom_col()`を使います。\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 部署ごとの売上データ\ndept_sales <- data.frame(\n  部署 = c(\"営業\", \"開発\", \"総務\"),\n  売上 = c(3500, 2800, 1500)\n)\n\nggplot(data = dept_sales, aes(x = 部署, y = 売上)) +\n  geom_col()\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n### 棒の色を変更\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dept_sales, aes(x = 部署, y = 売上)) +\n  geom_col(fill = \"steelblue\")\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n### カテゴリごとに色分け\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dept_sales, aes(x = 部署, y = 売上, fill = 部署)) +\n  geom_col()\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n## ヒストグラム（Histogram）\n\nデータの分布を確認するにはヒストグラムが適しています。\n\n### 基本的なヒストグラム\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# がく片の長さの分布\nggplot(data = iris, aes(x = Sepal.Length)) +\n  geom_histogram()\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n### ビン（区間）の数を調整\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ビンの数を指定\nggplot(data = iris, aes(x = Sepal.Length)) +\n  geom_histogram(bins = 20, fill = \"lightblue\", color = \"black\")\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n### 品種ごとに重ねて表示\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = iris, aes(x = Sepal.Length, fill = Species)) +\n  geom_histogram(alpha = 0.5, position = \"identity\", bins = 20)\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n## タイトルとラベルの追加\n\n`labs()`関数を使って、グラフにタイトルや軸ラベルを追加できます。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +\n  geom_point(size = 3, alpha = 0.7) +\n  labs(\n    title = \"アヤメのがく片の長さと幅\",\n    subtitle = \"品種ごとの比較\",\n    x = \"がく片の長さ (cm)\",\n    y = \"がく片の幅 (cm)\",\n    color = \"品種\"\n  )\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## テーマの変更\n\nggplot2には様々な組み込みテーマがあります。\n\n### theme_minimal()\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +\n  geom_point(size = 3) +\n  labs(title = \"シンプルなテーマ\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n### theme_classic()\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +\n  geom_point(size = 3) +\n  labs(title = \"クラシックなテーマ\") +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n### その他のテーマ\n\n- `theme_bw()`: 白黒テーマ\n- `theme_dark()`: 暗いテーマ\n- `theme_light()`: 明るいテーマ\n- `theme_void()`: 軸や背景を削除\n\n## 実践例：総合的なグラフ作成\n\nこれまで学んだ要素を組み合わせて、見やすいグラフを作成してみましょう。\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 売上データの作成\nsales_data <- data.frame(\n  月 = rep(1:6, times = 2),\n  店舗 = rep(c(\"東京店\", \"大阪店\"), each = 6),\n  売上 = c(120, 135, 150, 145, 160, 175,  # 東京店\n           100, 115, 130, 140, 155, 170)   # 大阪店\n)\n\n# 店舗別の月次売上推移\nggplot(data = sales_data, aes(x = 月, y = 売上, color = 店舗)) +\n  geom_line(linewidth = 1.2) +\n  geom_point(size = 3) +\n  labs(\n    title = \"店舗別月次売上推移\",\n    subtitle = \"2025年1月〜6月\",\n    x = \"月\",\n    y = \"売上（万円）\",\n    color = \"店舗名\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    legend.position = \"top\"\n  )\n```\n\n::: {.cell-output-display}\n![](visualization_basic_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n## グラフの保存\n\n作成したグラフは`ggsave()`で保存できます。\n\n```r\n# 最後に作成したグラフを保存\nggsave(\"outputs/sales_plot.png\", width = 8, height = 6)\n\n# 特定のグラフを保存\nmy_plot <- ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) +\n  geom_point()\n\nggsave(\"outputs/iris_plot.png\", plot = my_plot, width = 8, height = 6)\n```\n\n## 練習問題\n\n::: {.callout-tip collapse=\"true\"}\n## 問題1: 散布図の作成\n\n`iris`データで、`Petal.Length`（x軸）と`Petal.Width`（y軸）の散布図を作成してください。点は品種ごとに色分けしてください。\n\n**解答例**\n```r\nggplot(iris, aes(x = Petal.Length, y = Petal.Width, color = Species)) +\n  geom_point()\n```\n:::\n\n::: {.callout-tip collapse=\"true\"}\n## 問題2: 棒グラフの作成\n\n以下のデータで棒グラフを作成し、タイトルと軸ラベルを追加してください。\n\n```r\nproducts <- data.frame(\n  商品名 = c(\"商品A\", \"商品B\", \"商品C\", \"商品D\"),\n  販売数 = c(150, 230, 180, 210)\n)\n```\n\n**解答例**\n```r\nggplot(products, aes(x = 商品名, y = 販売数)) +\n  geom_col(fill = \"steelblue\") +\n  labs(\n    title = \"商品別販売数\",\n    x = \"商品名\",\n    y = \"販売数\"\n  )\n```\n:::\n\n::: {.callout-tip collapse=\"true\"}\n## 問題3: 折れ線グラフの作成\n\n以下のデータで折れ線グラフを作成し、点も一緒に表示してください。\n\n```r\ntemperature <- data.frame(\n  時刻 = c(0, 6, 12, 18, 24),\n  気温 = c(15, 12, 20, 18, 14)\n)\n```\n\n**解答例**\n```r\nggplot(temperature, aes(x = 時刻, y = 気温)) +\n  geom_line(color = \"red\", linewidth = 1) +\n  geom_point(size = 3) +\n  labs(\n    title = \"時刻別気温\",\n    x = \"時刻\",\n    y = \"気温（℃）\"\n  )\n```\n:::\n\n## まとめ\n\nこの章では、ggplot2の基本を学びました。\n\n- ✅ ggplot2の基本構造（`ggplot()` + `aes()` + `geom_*()`）\n- ✅ 散布図（`geom_point()`）\n- ✅ 折れ線グラフ（`geom_line()`）\n- ✅ 棒グラフ（`geom_bar()`, `geom_col()`）\n- ✅ ヒストグラム（`geom_histogram()`）\n- ✅ タイトルとラベルの追加（`labs()`）\n- ✅ テーマの変更（`theme_*()`）\n\nこれで基本的なグラフが作成できるようになりました。次の章では、さらに高度なカスタマイズ方法を学びます。\n\n::: {.callout-note}\n## 次のステップ\n\n次の章「データ可視化応用 - ggplot2発展」では、以下を学びます。\n\n- ファセット（複数グラフの並べて表示）\n- 軸のスケール調整\n- より細かいテーマのカスタマイズ\n- 日本語フォントの設定\n\nより洗練されたグラフ作成スキルを身につけましょう。\n:::\n",
    "supporting": [
      "visualization_basic_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}